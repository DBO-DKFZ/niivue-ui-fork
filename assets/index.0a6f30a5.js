import{R as r,j as d,B as u,a as e,I as C,d as Be,F as z,b as j,S as A,M as S,c as Me,D as E,e as Re,T as k,f as H,g as Ue,h as Ve,i as Oe,k as $e,l as Fe,m as _e,n as Ge,P as W,o as Ne,p as ze,q,r as x,s as je,t as Ae,u as Ee,v as He,N as We,w as K,x as qe,C as Ke}from"./vendor.841e210e.js";const Je=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))g(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&g(p)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function g(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}};Je();function Qe(n){const[i,o]=r.useState("multi");function g(s){let a=s.target.value,p=n.nvUpdateSliceType;o(a),p(a)}return d(u,{sx:{display:"flex",width:"100%",height:"64px",flexDirection:"row",justifyItems:"left",alignItems:"center",backgroundColor:"white"},children:[e(C,{onClick:n.toggleLayers,children:e(Be,{})}),d(z,{size:"small",sx:{m:2,minWidth:120},children:[e(j,{id:"slice-type-label",children:"Display mode"}),d(A,{labelId:"slice-type-label",id:"slice-type",value:i,label:"Display mode",onChange:g,children:[e(S,{value:"axial",children:"Axial"}),e(S,{value:"coronal",children:"Coronal"}),e(S,{value:"sagittal",children:"Sagittal"}),e(S,{value:"multi",children:"Multi"}),e(S,{value:"3d",children:"3D"})]})]}),e(C,{onClick:n.toggleSettings,style:{marginLeft:"auto"},children:e(Me,{})})]})}function Xe(n){return e(E,{open:n.open,variant:"temporary",anchor:"right",sx:{width:n.width},children:d(u,{sx:{width:n.width,role:"presentation",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e(u,{sx:{display:"flex",marginBottom:"10px"},children:e(C,{onClick:n.toggleMenu,style:{marginRight:"auto"},children:e(Re,{})})}),n.children]})})}function D(n){const[i,o]=r.useState("#ff0000");r.useEffect(()=>{let c=g(n.colorRGB01),h=a(c);console.log(n.title),console.log(c),console.log(h),console.log("end use effect"),o(h)},[]);function g(c){return[Math.round(c[0]*255),Math.round(c[1]*255),Math.round(c[2]*255)]}function s(c){var h=c.toString(16);return h.length==1?"0"+h:h}function a(c){return"#"+s(c[0])+s(c[1])+s(c[2])}function p(c){return[parseInt(c.substring(1,3),16),parseInt(c.substring(3,5),16),parseInt(c.substring(5),16)]}function b(c){let h=c.target.value;console.log(h),o(h);let m=p(h).map(y=>y/255);n.onSetColor(m)}return d(u,{sx:{display:"flex"},m:1,children:[e(k,{style:{marginRight:"auto"},children:n.title}),e(H,{disableUnderline:!1,autoFocus:!1,type:"color",style:{width:"50px",height:"20px"},onInput:b,value:i})]})}function w(n){const[i,o]=r.useState(n.value);r.useEffect(()=>{o(n.value)},[]);function g(s){let a=s.target.value;a<n.min&&(a=n.min),a>n.max&&(a=n.max),o(a),n.onChange(a)}return d(u,{sx:{display:"flex"},m:1,children:[e(k,{style:{marginRight:"auto"},children:n.title}),e(H,{disableUnderline:!0,type:"number",style:{width:"50px",height:"20px"},onInput:g,value:i,inputProps:{step:n.step}})]})}function Ye(n){function i(){let o=document.createElement("input");o.type="file",o.onchange=async function(){n.onAddLayer(o.files[0])},o.click()}return e(E,{open:n.open,variant:"temporary",anchor:"left",sx:{width:n.width},children:d(u,{sx:{width:n.width,display:"flex",flexDirection:"row",height:"100%"},children:[d(u,{sx:{width:48,display:"flex",flexDirection:"column",backgroundColor:"#F8F8F8",height:"100%",alignItems:"center"},children:[e(C,{style:{marginTop:"36px"},children:e(Ue,{color:"primary"})}),e(C,{style:{marginTop:"8px"},children:e(Ve,{})})]}),d(u,{sx:{width:n.width,role:"presentation",display:"flex",height:"100%",flexDirection:"column",justifyContent:"flex-start",ml:1,mr:1},children:[e(u,{sx:{display:"flex"},children:e(C,{onClick:n.onToggleMenu,style:{marginLeft:"auto"},children:e(Oe,{})})}),e(u,{sx:{display:"flex"},children:e($e,{onClick:i,endIcon:e(Fe,{}),size:"small",children:"Add Layer"})}),n.children]})]})})}function Ze(n){const i=r.useRef(null);return r.useEffect(async()=>{const o=n.nv;o.attachToCanvas(i.current),await o.loadVolumes(n.volumes)},[]),e(u,{sx:{display:"flex",width:"100%",height:"90"},children:e("canvas",{ref:i,height:480,width:640})})}function v(n){function i(){n.onChange()}return d(u,{sx:{display:"flex",alignItems:"center"},m:1,children:[e(k,{onClick:i,style:{marginRight:"auto"},children:n.title}),e(_e,{checked:n.checked,onChange:i})]})}function et(n){let i="none";return n.isVisible?i="":i="none",e(Ge,{sx:{display:i,marginTop:"auto",maxHeight:"30%",flexGrow:1},component:W,children:d(Ne,{sx:{minWidth:300},children:[e(ze,{children:d(q,{children:[e(x,{children:"Image"}),e(x,{align:"right",children:"Value"}),e(x,{align:"right",children:"MM"}),e(x,{align:"right",children:"Vox"})]})}),e(je,{children:n.tableData.map(o=>d(q,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e(x,{component:"th",scope:"row",children:o.name}),e(x,{align:"right",children:o.value.toFixed(n.decimalPrecision)}),e(x,{align:"right",children:`${o.mm[0].toFixed(n.decimalPrecision)} ${o.mm[1].toFixed(n.decimalPrecision)} ${o.mm[2].toFixed(n.decimalPrecision)}`}),e(x,{align:"right",children:`${o.vox[0]} ${o.vox[1]} ${o.vox[2]}`})]},o.id))})]})})}function tt(n){const i=n.image,[o,g]=r.useState(!1),[s,a]=r.useState(i.colorMap);let p=o?e(Ee,{}):e(He,{}),b=i.colorMaps().map(m=>e(S,{value:m,children:m},m));function c(){g(!o)}function h(m){let y=m.target.value,L=i.id;console.log(y),n.onColorMapChange(L,y),a(y)}function T(){n.onRemoveLayer(i)}return e(u,{sx:{display:"flex",flexDirection:"column"},children:d(W,{elevation:2,sx:{marginTop:.5,marginBottom:.5},children:[d(u,{sx:{margin:1,display:"flex",flexDirection:"row",alignItems:"center"},children:[e(k,{children:i.name}),e(C,{onClick:c,style:{marginLeft:"auto"},children:p})]}),e(u,{sx:{display:o?"flex":"none"},children:d(u,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"},m:1,children:[d(z,{children:[e(j,{children:"Color"}),e(A,{style:{width:"200px"},value:s,label:"Color",size:"small",onChange:h,children:b})]}),e(C,{onClick:T,children:e(Ae,{})})]})})]})})}const t=new We({loadingText:"loading..."});function nt(n){const[i,o]=r.useState(!1),[g,s]=r.useState(!1),[a,p]=r.useState(t.opts.crosshairColor),[b,c]=r.useState(t.opts.selectionBoxColor),[h,T]=r.useState(t.opts.backColor),[m,y]=r.useState(t.opts.clipPlaneColor),[L,P]=r.useState(t.volumes),[I,J]=r.useState(!1),[B,Q]=r.useState(!1),[M,X]=r.useState(!1),[Y,Z]=r.useState(t.opts.textHeight),[R,ee]=r.useState(t.opts.isColorbar),[U,te]=r.useState(t.opts.isSliceMM),[$,V]=r.useState(t.currentClipPlaneIndex>0),[ne,le]=r.useState(t.opts.crosshairColor[3]),[oe,ie]=r.useState(t.opts.clipPlaneColor[3]),[O,ae]=r.useState(!1),[re,se]=r.useState([]),[F,ce]=r.useState(2);r.useEffect(()=>{n.volumes.map(async l=>{let f=await K.loadFromUrl({url:l.url});t.addVolume(f),P([...t.volumes])})},[]),t.opts.onImageLoaded=()=>{P([...t.volumes])},t.opts.onLocationChange=l=>{se(l.values)};const de=L.map(l=>e(tt,{image:l,onColorMapChange:De,onRemoveLayer:Ie},l.name));async function ue(l){const f=await K.loadFromFile({file:l});t.addVolume(f),P([...t.volumes])}function _(){o(!i)}function G(){s(!g)}function he(){ae(!O)}function fe(l,f=1){p([...l,f]),t.setCrosshairColor([...l,f])}function ge(l,f=1){T([...l,f]),t.opts.backColor=[...l,f],t.drawScene()}function me(l,f=1){y([...l,f]),t.opts.clipPlaneColor=[...l,f],V(!0),t.setClipPlane([0,270,0]),t.updateGLVolume()}function pe(){$?(V(!1),t.setClipPlane([2,0,0])):(V(!0),t.setClipPlane([0,270,0]))}function Ce(){ee(!R),t.opts.isColorbar=!R,t.drawScene()}function xe(l){Z(l),t.opts.textHeight=l,t.drawScene()}function ye(l){ce(l)}function ve(){N(),te(!U),t.setSliceMM(!U)}function Se(){t.setCornerOrientationText(!I),J(!I)}function N(){t.opts.show3Dcrosshair=!M,t.updateGLVolume(),X(!M)}function be(){t.setRadiologicalConvention(!B),Q(!B)}function we(l){t.setCrosshairColor([a[0],a[1],a[2],l]),le(l)}function Te(l){t.opts.clipPlaneColor=[m[0],m[1],m[2],l],ie(l),t.updateGLVolume()}function Le(l){t.opts.crosshairWidth=l,t.drawScene()}function Pe(l){c([...l,.5]),t.setSelectionBoxColor([...l,.5])}function ke(l){l==="axial"?t.setSliceType(t.sliceTypeAxial):l==="coronal"?t.setSliceType(t.sliceTypeCoronal):l==="sagittal"?t.setSliceType(t.sliceTypeSagittal):l==="multi"?t.setSliceType(t.sliceTypeMultiplanar):l==="3d"&&t.setSliceType(t.sliceTypeRender)}function De(l,f){t.volumes[t.getVolumeIndexByID(l)].setColorMap(f),t.updateGLVolume()}function Ie(l){t.removeVolume(l),P([...t.volumes])}return t.on("intensityRange",l=>{}),d(u,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"black"},children:[d(Xe,{open:i,width:300,toggleMenu:_,children:[e(D,{colorRGB01:h,onSetColor:ge,title:"Background color"}),e(D,{colorRGB01:m,onSetColor:me,title:"Clip plane color"}),e(w,{value:oe,onChange:Te,title:"Clip plane opacity",min:0,max:1,step:.1}),e(D,{colorRGB01:a,onSetColor:fe,title:"Crosshair color"}),e(w,{value:ne,onChange:we,title:"Crosshair opacity",min:0,max:1,step:.1}),e(D,{colorRGB01:b,onSetColor:Pe,title:"Selection box color"}),e(w,{value:t.opts.crosshairWidth,onChange:Le,title:"Crosshair size",min:0,max:10,step:1}),e(w,{value:Y,onChange:xe,title:"Text size",min:0,max:.2,step:.01}),e(v,{checked:O,title:"Location table",onChange:he}),e(v,{checked:$,title:"Clip plane",onChange:pe}),e(v,{checked:I,title:"Corner text",onChange:Se}),e(v,{checked:B,title:"radiological",onChange:be}),e(v,{checked:M,title:"3D crosshair",onChange:N}),e(v,{checked:R,title:"Show color bar",onChange:Ce}),e(v,{checked:U,title:"World space",onChange:ve}),e(w,{value:F,onChange:ye,title:"Decimal precision",min:0,max:8,step:1})]}),e(Ye,{open:g,width:320,onToggleMenu:G,onAddLayer:ue,children:de}),e(Qe,{nvUpdateSliceType:ke,toggleSettings:_,toggleLayers:G}),e(Ze,{nv:t,volumes:L}),e(et,{tableData:re,isVisible:O,decimalPrecision:F})]})}const lt=[{url:"./mni152.nii",name:"mni152"}];qe.render(d(r.StrictMode,{children:[e(Ke,{enableColorScheme:!0}),e(nt,{volumes:lt})]}),document.getElementById("root"));
